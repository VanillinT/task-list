(this["webpackJsonpbeejee-test-task"]=this["webpackJsonpbeejee-test-task"]||[]).push([[0],{87:function(e,t,n){},94:function(e,t,n){"use strict";n.r(t);var a,r=n(4),c=n(0),o=n.n(c),i=n(10),s=n.n(i),u=(n(87),n(9)),l=n(46),d=n(13),b=n(62),j=n(16),f=Object(j.c)({name:"notifications",initialState:{items:[]},reducers:{notificationAdded:function(e,t){var n=t.payload;e.items.push(n)},notificationRemoved:function(e,t){var n=t.payload;return{items:e.items.filter((function(e){return e.key!==n}))}}}}),p=f.reducer,O=f.actions,h=O.notificationAdded,m=O.notificationRemoved,v=[],g=function(){var e=Object(d.b)(),t=Object(d.c)((function(e){return e.notifications.items})),n=Object(b.b)(),a=n.enqueueSnackbar,r=n.closeSnackbar;return Object(c.useEffect)((function(){t.forEach((function(t){var n,c=t.key,o=t.message,i=t.options,s=void 0===i?{}:i,d=t.dismissed;void 0!==d&&d?r(c):v.includes(c)||(a(o,Object(u.a)(Object(u.a)({key:c},s),{},{onClose:function(e,t,n){s.onClose&&s.onClose(e,t,n)},onExited:function(t,n){var a;e(m(n)),a=n,v=Object(l.a)(v.filter((function(e){return a!==e})))}})),n=c,v=[].concat(Object(l.a)(v),[n]))}))}),[t,r,a,e]),null},x=n(142),k=n(131),y=n(140),w=n(24),C=n(20),N=n.n(C),S=n(35),I=n(30),E=n(72),T=function(){var e=Object(S.a)(N.a.mark((function e(t){var n,a,r,c,o,i;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.method,a=t.path,r=t.params,c=t.data,o="https://uxcandy.com/~shapoval/test-task-backend/v2"+a+"?developer=VanillinT",r&&Object.entries(r).forEach((function(e){var t=Object(I.a)(e,2),n=t[0],a=t[1];return o+="&".concat(n,"=").concat(a)})),e.next=5,Object(E.ajax)({url:o,method:n,crossDomain:!0,mimeType:"multipart/form-data",contentType:!1,processData:!1,data:c,dataType:"json"});case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(e){var t=e.path,n=e.params;return T({method:"GET",path:t,params:n})},L=function(e){var t=e.path,n=e.data,a=new FormData;return Object.entries(n).forEach((function(e){var t=Object(I.a)(e,2),n=t[0],r=t[1];a.append(n,r)})),T({method:"POST",path:t,data:a})},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{page:1};return D({path:"/",params:e})},R=function(e){return L({path:"/create",data:e})},M=function(e,t){var n=e.token;return Promise.all(t.map((function(e){return function(e,t){var n=e.token;return L({path:"/edit/".concat(t.id),data:Object(u.a)(Object(u.a)({},t),{},{token:n})})}({token:n},e)})))},P=function(e,t,n){var a=!!t.length,r=a?"ok"===t[0].status:"ok"===t.status;e(h({message:r?n:"ERROR: ".concat(JSON.stringify((a?t[0]:t).message)),key:(new Date).getTime()+Math.random(),options:{variant:r?"success":"error"}}))},A=Object(j.c)({name:"modal",initialState:{open:!1},reducers:{modalOpened:function(){return{open:!0}},modalClosed:function(){return{open:!1}}}}),_=A.reducer,F=A.actions,U=F.modalOpened,W=F.modalClosed,z=Object(j.b)("tasks/tasksLoaded",function(){var e=Object(S.a)(N.a.mark((function e(t,n){var a,r,c,o,i,s;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.getState,r=a().tasksListState,c=r.orderBy,o=r.sortDirection,i=r.currentPage,s=B({page:i,sort_field:c,sort_direction:o}),e.abrupt("return",s);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),J=Object(j.b)("tasks/taskCreated",function(){var e=Object(S.a)(N.a.mark((function e(t,n){var a,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.dispatch,(r=R(t)).then((function(e){P(a,e,"New task created successfuly"),"ok"===e.status&&(a(W()),a(z()))})),e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),q=Object(j.b)("tasks/tasksSaved",function(){var e=Object(S.a)(N.a.mark((function e(t,n){var a,r,c,o,i,s,u;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.dispatch,r=n.getState,c=r(),o=c.user.token,i=c.tasks.unsavedItems,s=i.length,(u=M({token:o},i)).then((function(e){P(a,e,1===s?"Task ".concat(i[0].id," has been updated"):"".concat(s," tasks have been updated"))})),e.abrupt("return",u);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),G=Object(j.c)({name:"tasks",initialState:{items:[],unsavedItems:[],status:"idle",error:null,totalItems:0},reducers:{taskEditedLocally:function(e,t){var n=t.payload;e.items=e.items.map((function(e){return e.id===n.id?n:e})),e.unsavedItems=[].concat(Object(l.a)(e.unsavedItems.filter((function(e){return e.id!==n.id}))),[n])},errorNullified:function(e){return Object(u.a)(Object(u.a)({},e),{},{error:null})}},extraReducers:(a={},Object(w.a)(a,z.fulfilled,(function(e,t){var n=t.payload,a=n.message,r=n.status;if(e.status=r,"error"===r)e.error=a;else{var c=a.tasks,o=a.total_task_count;e.items=Object(l.a)(c),e.totalItems=o}})),Object(w.a)(a,J.fulfilled,(function(e,t){var n=t.payload,a=n.message,r=n.status;e.status=r,"error"===r?e.error=a:e.length<3&&e.items.push(a)})),Object(w.a)(a,q.fulfilled,(function(e,t){t.payload.every((function(e){return"ok"===e.status}))&&(e.unsavedItems=[])})),a)}),K=G.reducer,V=G.actions,$=V.taskEditedLocally,H=V.errorNullified,Q=function(e){return{tasks:e.tasks.items,count:e.tasks.totalItems}},X=function(e){return e.tasks.unsavedItems},Y=function(e){return 0===e.length?"Enter Email":/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?"":"Incorrect email format."},Z=function(e){return 0===e.length?"Enter Username":e.length<3?"Username is too short":e.length>14?"Username is too long":""},ee=function(e){return function(t){return 0===t.length?e:""}},te=n(129),ne=Object(te.a)({modal:{display:"flex",alignItems:"center",justifyContent:"center"},wrapper:{outline:"none"}}),ae=Object(te.a)({tableContainer:{height:400},tableBody:{position:"relative"},utilsWrapper:{display:"flex",width:"100%",justifyContent:"space-between",padding:10,margin:"auto"},button:{marginRight:10},pagination:{},textField:{width:"100%",border:"none"}}),re=n(145),ce=n(139),oe=n(7),ie=n(130),se=Object(te.a)((function(e){return{form:{background:"white",borderRadius:5,minWidth:300,boxShadow:e.shadows[16]},header:{backgroundColor:e.palette.secondary.light,padding:"0 30px",borderRadius:"5px 5px 0 0"},body:{padding:"0 20px 20px",display:"flex",flexDirection:"column"},input:{marginTop:"15px"},backdrop:{backgroundColor:"transparent"}}})),ue=function(e){var t=e.submitButtonLabel,n=void 0===t?"OK":t,a=e.title,o=void 0===a?"":a,i=e.fieldsOptionsMap,s=e.onSubmit,l=e.errors,d=se(),b=Object(c.useMemo)((function(){return Object.keys(i)})),j=function(){return b.reduce((function(e,t){return Object(u.a)(Object(u.a)({},e),{},Object(w.a)({},t,""))}),{})},f=Object(c.useState)(j()),p=Object(I.a)(f,2),O=p[0],h=p[1],m=Object(c.useState)(j()),v=Object(I.a)(m,2),g=v[0],x=v[1],k=function(e,t,n){return e((function(e){return Object(u.a)(Object(u.a)({},e),{},Object(w.a)({},t,n))}))},y=function(e,t){e.preventDefault(),function(e,t){k(h,e,t)}(t,e.target.value),x(j())};Object(c.useEffect)((function(){x(Object(u.a)(Object(u.a)({},g),l))}),[l]);var C=function(){var e=0;return b.forEach((function(t){var n=i[t].validator,a=O[t];if(n){var r=n(a);r&&e++,function(e,t){k(x,e,t)}(t,r)}})),e};return Object(r.jsxs)(re.a,{className:d.form,children:[o&&Object(r.jsx)("div",{className:d.header,children:Object(r.jsx)("h2",{children:o})}),Object(r.jsxs)("div",{className:d.body,children:[b.map((function(e){return Object(r.jsx)(ce.a,Object(u.a)({className:d.input,variant:"outlined",label:g[e]||Object(oe.a)(e),value:O[e],onChange:function(t){return y(t,e)},error:!!g[e]},function(e){return i[e]&&i[e].props?i[e].props:{}}(e)),e)})),Object(r.jsx)(ie.a,{className:d.input,variant:"outlined",onClick:function(){C()>0||s&&s(O)},children:n})]})]})},le=function(){var e=Object(d.c)((function(e){return e.newTaskModal.open})),t=Object(d.c)((function(e){return e.tasks.error})),n=Object(d.b)(),a=ne(),c={username:{validator:Z},email:{validator:Y},text:{validator:ee("This field cannot be empty"),props:{multiline:!0,rows:3,rowsMax:5}}};return Object(r.jsx)(x.a,{open:e,onClose:function(){n(W()),n(H())},className:a.modal,closeAfterTransition:!0,children:Object(r.jsx)(k.a,{in:e,children:Object(r.jsx)(y.a,{className:a.wrapper,children:Object(r.jsx)(ue,{fieldsOptionsMap:c,errors:t,onSubmit:function(e){n(J(e))},title:"Add new task",submitButtonLabel:"Add"})})})})},de=n(132),be=n(133),je=n(134),fe=n(135),pe=n(136),Oe=n(146),he=n(137),me=n(143),ve=n(141),ge=Object(j.b)("auth/loggedIn",function(){var e=Object(S.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",L({path:"/login",data:t}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),xe=Object(j.c)({name:"user",initialState:{loggedIn:!1,token:null,status:"idle",error:null},reducers:{loggedOut:function(e){e.loggedIn=!1,e.token=null},errorNullified:function(e){return Object(u.a)(Object(u.a)({},e),{},{error:null})}},extraReducers:Object(w.a)({},ge.fulfilled,(function(e,t){var n=t.payload,a=n.status,r=n.message;if(e.status=a,"error"===a)e.error=r;else{var c=r.token;e.token=c,c.length>0&&(e.loggedIn=!0)}}))}),ke=xe.reducer,ye=xe.actions,we=ye.loggedOut,Ce=ye.errorNullified,Ne=function(e){return e.user.loggedIn},Se=Object(j.c)({name:"tasksListState",initialState:{orderBy:null,sortDirection:"desc",currentPage:1},reducers:{orderByChanged:function(e,t){var n=t.payload;return Object(u.a)(Object(u.a)({},e),{},{orderBy:n})},sortDirectionChanged:function(e,t){var n=t.payload;return Object(u.a)(Object(u.a)({},e),{},{sortDirection:n})},currentPageChanged:function(e,t){var n=t.payload;return Object(u.a)(Object(u.a)({},e),{},{currentPage:n})}}}),Ie=Se.reducer,Ee=Se.actions,Te=Ee.orderByChanged,De=Ee.sortDirectionChanged,Le=Ee.currentPageChanged,Be=function(e){return e.tasksListState},Re=[{label:"Id",sortable:!0,width:75},{label:"Username",sortable:!0,width:125},{label:"Email",sortable:!0,width:160},{label:"Text",sortable:!1,width:240},{label:"Status",sortable:!0,width:100}],Me=function(){var e=ae(),t=Object(d.b)(),n=Object(d.c)(Be),a=n.orderBy,o=n.sortDirection,i=n.currentPage,s=Object(d.c)(Ne),l=Object(d.c)(X),b=Object(d.c)(Q),j=b.tasks,f=b.count,p=Math.ceil(f/3),O=function(e){t($(e))};return Object(c.useEffect)((function(){t(z())}),[i,o,a]),Object(r.jsxs)(y.a,{children:[Object(r.jsxs)(y.a,{className:e.utilsWrapper,children:[Object(r.jsxs)(y.a,{children:[Object(r.jsx)(ie.a,{className:e.button,variant:"outlined",onClick:function(){return t(U())},endIcon:Object(r.jsx)("span",{className:"material-icons",children:"add_task"}),children:"New task"}),l.length>0&&Object(r.jsx)(ie.a,{className:e.button,variant:"outlined",onClick:function(){t(q())},endIcon:Object(r.jsx)("span",{className:"material-icons",children:"save"}),children:"Save"})]}),p>0&&Object(r.jsx)(ve.a,{className:e.pagination,count:p,shape:"rounded",onChange:function(e,n){t(Le(n))}})]}),j&&j.length?Object(r.jsx)(de.a,{className:e.tableContainer,children:Object(r.jsxs)(be.a,{children:[Object(r.jsx)(je.a,{children:Object(r.jsx)(fe.a,{children:Re.map((function(e){return Object(r.jsx)(pe.a,{width:e.width,children:e.sortable?Object(r.jsx)(Oe.a,{active:a===e.label,direction:o,onClick:function(){return n=e.label,void t(a!==n?Te(n):De("desc"===o?"asc":"desc"));var n},children:e.label}):e.label},e.label)}))})}),Object(r.jsx)(he.a,{className:e.tableBody,children:j.map((function(t){return Object(r.jsxs)(fe.a,{children:[Object(r.jsx)(pe.a,{children:t.id}),Object(r.jsx)(pe.a,{children:t.username}),Object(r.jsx)(pe.a,{children:t.email}),Object(r.jsx)(pe.a,{children:Object(r.jsx)(ce.a,{className:e.textField,variant:"outlined",value:t.text,multiline:!0,rowsMax:3,disabled:!s,onChange:function(e){return function(e,t){O(Object(u.a)(Object(u.a)({},t),{},{text:e.target.value}))}(e,t)}})}),Object(r.jsx)(pe.a,{children:Object(r.jsx)(me.a,{checked:10===t.status,onClick:function(e){return function(e,t){O(Object(u.a)(Object(u.a)({},t),{},{status:e.target.checked?10:0}))}(e,t)},disabled:!s})})]},t.id)}))})]})}):null,Object(r.jsx)(le,{})]})},Pe=n(138),Ae=n(144),_e=function(e){var t=e.anchorEl,n=e.open,a=e.onClose,c=Object(d.b)(),o=Object(d.c)((function(e){return e.user.error})),i={username:{validator:Z},password:{validator:ee("Enter password"),props:{type:"password"}}},s=n?"simple-popover":void 0;return Object(r.jsx)(Ae.a,{id:s,open:n,anchorEl:t,onClose:function(){a(),c(Ce())},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},children:Object(r.jsx)(ue,{submitButtonLabel:"Log in",fieldsOptionsMap:i,onSubmit:function(e){c(ge(e)).then((function(e){"ok"===e.payload.status&&a&&a()}))},errors:o})})},Fe=Object(te.a)({body:{display:"flex",paddingTop:100,width:"100%",justifyContent:"center",fontSize:"calc(10px + 2vmin)"}}),Ue=Object(te.a)((function(e){return{header:{position:"fixed",display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",padding:"20px",backgroundColor:e.palette.secondary.light},logo:{pointerEvents:"none"}}})),We=(Object(te.a)({loginPopover:{display:"flex",flexDirection:"column",padding:"0 20px",minWidth:250}}),function(){var e=Object(d.c)(Ne),t=Object(d.b)(),n=o.a.useState(null),a=Object(I.a)(n,2),c=a[0],i=a[1],s=o.a.useState(!1),u=Object(I.a)(s,2),l=u[0],b=u[1],j=Ue();return Object(r.jsxs)(y.a,{className:j.header,children:[Object(r.jsx)(Pe.a,{variant:"h4",className:j.logo,children:"Tasks list"}),Object(r.jsx)("div",{children:e?Object(r.jsx)(ie.a,{onClick:function(){t(we())},disableRipple:!0,endIcon:Object(r.jsx)("span",{className:"material-icons",children:"logout"}),children:"Log Out"}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(ie.a,{onClick:function(e){i(e.currentTarget),b((function(e){return!e}))},disableRipple:!0,endIcon:Object(r.jsx)("span",{className:"material-icons",children:"login"}),children:"Log in"}),Object(r.jsx)(_e,{anchorEl:c,open:l,onClose:function(){b(!1)}})]})})]})}),ze=function(){var e=Fe();return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)(g,{}),Object(r.jsx)(We,{}),Object(r.jsx)("div",{className:e.body,children:Object(r.jsx)(Me,{})})]})},Je=Object(j.a)({reducer:{tasks:K,tasksListState:Ie,newTaskModal:_,user:ke,notifications:p}});s.a.render(Object(r.jsx)(d.a,{store:Je,children:Object(r.jsx)(b.a,{maxSnack:3,children:Object(r.jsx)(ze,{})})}),document.getElementById("root"))}},[[94,1,2]]]);
//# sourceMappingURL=main.07b88216.chunk.js.map