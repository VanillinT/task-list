(this["webpackJsonpbeejee-test-task"]=this["webpackJsonpbeejee-test-task"]||[]).push([[0],{87:function(t,e,n){},94:function(t,e,n){"use strict";n.r(e);var a,r=n(4),c=n(0),i=n.n(c),o=n(10),s=n.n(o),u=(n(87),n(9)),l=n(46),d=n(13),b=n(62),j=n(16),f=Object(j.c)({name:"notifications",initialState:{items:[]},reducers:{notificationAdded:function(t,e){var n=e.payload;t.items.push(n)},notificationRemoved:function(t,e){var n=e.payload;return{items:t.items.filter((function(t){return t.key!==n}))}}}}),p=f.reducer,O=f.actions,h=O.notificationAdded,m=O.notificationRemoved,v=[],g=function(){var t=Object(d.b)(),e=Object(d.c)((function(t){return t.notifications.items})),n=Object(b.b)(),a=n.enqueueSnackbar,r=n.closeSnackbar;return Object(c.useEffect)((function(){e.forEach((function(e){var n,c=e.key,i=e.message,o=e.options,s=void 0===o?{}:o,d=e.dismissed;void 0!==d&&d?r(c):v.includes(c)||(a(i,Object(u.a)(Object(u.a)({key:c},s),{},{onClose:function(t,e,n){s.onClose&&s.onClose(t,e,n)},onExited:function(e,n){var a;t(m(n)),a=n,v=Object(l.a)(v.filter((function(t){return a!==t})))}})),n=c,v=[].concat(Object(l.a)(v),[n]))}))}),[e,r,a,t]),null},x=n(142),k=n(131),y=n(140),w=n(24),C=n(20),N=n.n(C),S=n(35),I=n(30),E=n(72),T=function(){var t=Object(S.a)(N.a.mark((function t(e){var n,a,r,c,i,o;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.method,a=e.path,r=e.params,c=e.data,i="https://uxcandy.com/~shapoval/test-task-backend/v2"+a+"?developer=VanillinT",r&&Object.entries(r).forEach((function(t){var e=Object(I.a)(t,2),n=e[0],a=e[1];return i+="&".concat(n,"=").concat(a)})),t.next=5,Object(E.ajax)({url:i,method:n,crossDomain:!0,mimeType:"multipart/form-data",contentType:!1,processData:!1,data:c,dataType:"json"});case 5:return o=t.sent,t.abrupt("return",o);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),D=function(t){var e=t.path,n=t.params;return T({method:"GET",path:e,params:n})},L=function(t){var e=t.path,n=t.data,a=new FormData;return Object.entries(n).forEach((function(t){var e=Object(I.a)(t,2),n=e[0],r=e[1];a.append(n,r)})),T({method:"POST",path:e,data:a})},B=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{page:1};return D({path:"/",params:t})},R=function(t){return L({path:"/create",data:t})},M=function(t,e){var n=t.token;return Promise.all(e.map((function(t){return function(t,e){var n=t.token;return L({path:"/edit/".concat(e.id),data:Object(u.a)(Object(u.a)({},e),{},{token:n})})}({token:n},t)})))},P=function(t,e,n){var a=!!e.length,r=a?"ok"===e[0].status:"ok"===e.status,c=(a?e[0]:e).message;t(h({message:r?n:"ERROR: ".concat(JSON.stringify(c)),key:(new Date).getTime()+Math.random(),options:{variant:r?"success":"error"}}))},A=function(){var t,e;return(null===(t=document.cookie.split(";"))||void 0===t||null===(e=t.find((function(t){return t.trim().startsWith("token")})))||void 0===e?void 0:e.split("=")[1])||""},W=function(t){document.cookie="token=".concat(t,"; path=/")},_=Object(j.c)({name:"modal",initialState:{open:!1},reducers:{modalOpened:function(){return{open:!0}},modalClosed:function(){return{open:!1}}}}),F=_.reducer,U=_.actions,z=U.modalOpened,J=U.modalClosed,q=Object(j.b)("tasks/tasksLoaded",function(){var t=Object(S.a)(N.a.mark((function t(e,n){var a,r,c,i,o,s;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.getState,r=a().tasksListState,c=r.orderBy,i=r.sortDirection,o=r.currentPage,s=B({page:o,sort_field:c,sort_direction:i}),t.abrupt("return",s);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),G=Object(j.b)("tasks/taskCreated",function(){var t=Object(S.a)(N.a.mark((function t(e,n){var a,r;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.dispatch,(r=R(e)).then((function(t){P(a,t,"New task created successfuly"),"ok"===t.status&&(a(J()),a(q()))})),t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),K=Object(j.b)("tasks/tasksSaved",function(){var t=Object(S.a)(N.a.mark((function t(e,n){var a,r,c,i,o,s,u;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.dispatch,r=n.getState,c=r(),i=A(),o=c.tasks.unsavedItems,s=o.length,(u=M({token:i},o)).then((function(t){P(a,t,1===s?"Task ".concat(o[0].id," has been updated"):"".concat(s," tasks have been updated"))})),t.abrupt("return",u);case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),V=Object(j.c)({name:"tasks",initialState:{items:[],unsavedItems:[],status:"idle",error:null,totalItems:0},reducers:{taskEditedLocally:function(t,e){var n=e.payload;t.items=t.items.map((function(t){return t.id===n.id?n:t})),t.unsavedItems=[].concat(Object(l.a)(t.unsavedItems.filter((function(t){return t.id!==n.id}))),[n])},errorNullified:function(t){return Object(u.a)(Object(u.a)({},t),{},{error:null})}},extraReducers:(a={},Object(w.a)(a,q.fulfilled,(function(t,e){var n=e.payload,a=n.message,r=n.status;if(t.status=r,"error"===r)t.error=a;else{var c=a.tasks,i=a.total_task_count;t.items=Object(l.a)(c),t.totalItems=i}})),Object(w.a)(a,G.fulfilled,(function(t,e){var n=e.payload,a=n.message,r=n.status;t.status=r,"error"===r?t.error=a:t.length<3&&t.items.push(a)})),Object(w.a)(a,K.fulfilled,(function(t,e){e.payload.every((function(t){return"ok"===t.status}))&&(t.unsavedItems=[])})),a)}),$=V.reducer,H=V.actions,Q=H.taskEditedLocally,X=H.errorNullified,Y=function(t){return{tasks:t.tasks.items,count:t.tasks.totalItems}},Z=function(t){return t.tasks.unsavedItems},tt=function(t){return 0===t.length?"Enter Email":/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?"":"Incorrect email format."},et=function(t){return 0===t.length?"Enter Username":t.length<3?"Username is too short":t.length>14?"Username is too long":""},nt=function(t){return function(e){return 0===e.length?t:""}},at=n(129),rt=Object(at.a)({modal:{display:"flex",alignItems:"center",justifyContent:"center"},wrapper:{outline:"none"}}),ct=Object(at.a)({tableContainer:{height:400},tableBody:{position:"relative"},utilsWrapper:{display:"flex",width:"100%",justifyContent:"space-between",padding:10,margin:"auto"},button:{marginRight:10},pagination:{},textField:{width:"100%",border:"none"}}),it=n(145),ot=n(139),st=n(7),ut=n(130),lt=Object(at.a)((function(t){return{form:{background:"white",borderRadius:5,minWidth:300,boxShadow:t.shadows[16]},header:{backgroundColor:t.palette.secondary.light,padding:"0 30px",borderRadius:"5px 5px 0 0"},body:{padding:"0 20px 20px",display:"flex",flexDirection:"column"},input:{marginTop:"15px"},backdrop:{backgroundColor:"transparent"}}})),dt=function(t){var e=t.submitButtonLabel,n=void 0===e?"OK":e,a=t.title,i=void 0===a?"":a,o=t.fieldsOptionsMap,s=t.onSubmit,l=t.errors,d=lt(),b=Object(c.useMemo)((function(){return Object.keys(o)})),j=function(){return b.reduce((function(t,e){return Object(u.a)(Object(u.a)({},t),{},Object(w.a)({},e,""))}),{})},f=Object(c.useState)(j()),p=Object(I.a)(f,2),O=p[0],h=p[1],m=Object(c.useState)(j()),v=Object(I.a)(m,2),g=v[0],x=v[1],k=function(t,e,n){return t((function(t){return Object(u.a)(Object(u.a)({},t),{},Object(w.a)({},e,n))}))},y=function(t,e){t.preventDefault(),function(t,e){k(h,t,e)}(e,t.target.value),x(j())};Object(c.useEffect)((function(){x(Object(u.a)(Object(u.a)({},g),l))}),[l]);var C=function(){var t=0;return b.forEach((function(e){var n=o[e].validator,a=O[e];if(n){var r=n(a);r&&t++,function(t,e){k(x,t,e)}(e,r)}})),t};return Object(r.jsxs)(it.a,{className:d.form,children:[i&&Object(r.jsx)("div",{className:d.header,children:Object(r.jsx)("h2",{children:i})}),Object(r.jsxs)("div",{className:d.body,children:[b.map((function(t){return Object(r.jsx)(ot.a,Object(u.a)({className:d.input,variant:"outlined",label:g[t]||Object(st.a)(t),value:O[t],onChange:function(e){return y(e,t)},error:!!g[t]},function(t){return o[t]&&o[t].props?o[t].props:{}}(t)),t)})),Object(r.jsx)(ut.a,{className:d.input,variant:"outlined",onClick:function(){C()>0||s&&s(O)},children:n})]})]})},bt=function(){var t=Object(d.c)((function(t){return t.newTaskModal.open})),e=Object(d.c)((function(t){return t.tasks.error})),n=Object(d.b)(),a=rt(),c={username:{validator:et},email:{validator:tt},text:{validator:nt("This field cannot be empty"),props:{multiline:!0,rows:3,rowsMax:5}}};return Object(r.jsx)(x.a,{open:t,onClose:function(){n(J()),n(X())},className:a.modal,closeAfterTransition:!0,children:Object(r.jsx)(k.a,{in:t,children:Object(r.jsx)(y.a,{className:a.wrapper,children:Object(r.jsx)(dt,{fieldsOptionsMap:c,errors:e,onSubmit:function(t){n(G(t))},title:"Add new task",submitButtonLabel:"Add"})})})})},jt=n(132),ft=n(133),pt=n(134),Ot=n(135),ht=n(136),mt=n(146),vt=n(137),gt=n(143),xt=n(141),kt={loggedIn:!!A().length,status:"idle",error:null},yt=Object(j.b)("auth/loggedIn",function(){var t=Object(S.a)(N.a.mark((function t(e){return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",L({path:"/login",data:e}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),wt=Object(j.c)({name:"user",initialState:kt,reducers:{loggedOut:function(t){W(""),t.loggedIn=!1},errorNullified:function(t){return Object(u.a)(Object(u.a)({},t),{},{error:null})}},extraReducers:Object(w.a)({},yt.fulfilled,(function(t,e){var n=e.payload,a=n.status,r=n.message;if(t.status=a,"error"===a)t.error=r;else{var c=r.token;W(c),c.length>0&&(t.loggedIn=!0)}}))}),Ct=wt.reducer,Nt=wt.actions,St=Nt.loggedOut,It=Nt.errorNullified,Et=function(t){return t.user.loggedIn},Tt=Object(j.c)({name:"tasksListState",initialState:{orderBy:null,sortDirection:"desc",currentPage:1},reducers:{orderByChanged:function(t,e){var n=e.payload;return Object(u.a)(Object(u.a)({},t),{},{orderBy:n})},sortDirectionChanged:function(t,e){var n=e.payload;return Object(u.a)(Object(u.a)({},t),{},{sortDirection:n})},currentPageChanged:function(t,e){var n=e.payload;return Object(u.a)(Object(u.a)({},t),{},{currentPage:n})}}}),Dt=Tt.reducer,Lt=Tt.actions,Bt=Lt.orderByChanged,Rt=Lt.sortDirectionChanged,Mt=Lt.currentPageChanged,Pt=function(t){return t.tasksListState},At=[{label:"Id",sortable:!0,width:75},{label:"Username",sortable:!0,width:125},{label:"Email",sortable:!0,width:160},{label:"Text",sortable:!1,width:240},{label:"Status",sortable:!0,width:100}],Wt=function(){var t=ct(),e=Object(d.b)(),n=Object(d.c)(Pt),a=n.orderBy,i=n.sortDirection,o=n.currentPage,s=Object(d.c)(Et),l=Object(d.c)(Z),b=Object(d.c)(Y),j=b.tasks,f=b.count,p=Math.ceil(f/3),O=function(t){e(Q(t))};return Object(c.useEffect)((function(){e(q())}),[o,i,a]),Object(r.jsxs)(y.a,{children:[Object(r.jsxs)(y.a,{className:t.utilsWrapper,children:[Object(r.jsxs)(y.a,{children:[Object(r.jsx)(ut.a,{className:t.button,variant:"outlined",onClick:function(){return e(z())},endIcon:Object(r.jsx)("span",{className:"material-icons",children:"add_task"}),children:"New task"}),l.length>0&&Object(r.jsx)(ut.a,{className:t.button,variant:"outlined",onClick:function(){e(K())},endIcon:Object(r.jsx)("span",{className:"material-icons",children:"save"}),children:"Save"})]}),p>0&&Object(r.jsx)(xt.a,{className:t.pagination,count:p,shape:"rounded",onChange:function(t,n){e(Mt(n))}})]}),j&&j.length?Object(r.jsx)(jt.a,{className:t.tableContainer,children:Object(r.jsxs)(ft.a,{children:[Object(r.jsx)(pt.a,{children:Object(r.jsx)(Ot.a,{children:At.map((function(t){return Object(r.jsx)(ht.a,{width:t.width,children:t.sortable?Object(r.jsx)(mt.a,{active:a===t.label,direction:i,onClick:function(){return n=t.label,void e(a!==n?Bt(n):Rt("desc"===i?"asc":"desc"));var n},children:t.label}):t.label},t.label)}))})}),Object(r.jsx)(vt.a,{className:t.tableBody,children:j.map((function(e){return Object(r.jsxs)(Ot.a,{children:[Object(r.jsx)(ht.a,{children:e.id}),Object(r.jsx)(ht.a,{children:e.username}),Object(r.jsx)(ht.a,{children:e.email}),Object(r.jsx)(ht.a,{children:Object(r.jsx)(ot.a,{className:t.textField,variant:"outlined",value:e.text,multiline:!0,rowsMax:3,disabled:!s,onChange:function(t){return function(t,e){O(Object(u.a)(Object(u.a)({},e),{},{text:t.target.value}))}(t,e)}})}),Object(r.jsx)(ht.a,{children:Object(r.jsx)(gt.a,{checked:10===e.status,onClick:function(t){return function(t,e){O(Object(u.a)(Object(u.a)({},e),{},{status:t.target.checked?10:0}))}(t,e)},disabled:!s})})]},e.id)}))})]})}):null,Object(r.jsx)(bt,{})]})},_t=n(138),Ft=n(144),Ut=function(t){var e=t.anchorEl,n=t.open,a=t.onClose,c=Object(d.b)(),i=Object(d.c)((function(t){return t.user.error})),o={username:{validator:et},password:{validator:nt("Enter password"),props:{type:"password"}}},s=n?"simple-popover":void 0;return Object(r.jsx)(Ft.a,{id:s,open:n,anchorEl:e,onClose:function(){a(),c(It())},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},children:Object(r.jsx)(dt,{submitButtonLabel:"Log in",fieldsOptionsMap:o,onSubmit:function(t){c(yt(t)).then((function(t){"ok"===t.payload.status&&a&&a()}))},errors:i})})},zt=Object(at.a)({body:{display:"flex",paddingTop:100,width:"100%",justifyContent:"center",fontSize:"calc(10px + 2vmin)"}}),Jt=Object(at.a)((function(t){return{header:{position:"fixed",display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",padding:"20px",backgroundColor:t.palette.secondary.light},logo:{pointerEvents:"none"}}})),qt=(Object(at.a)({loginPopover:{display:"flex",flexDirection:"column",padding:"0 20px",minWidth:250}}),function(){var t=Object(d.c)(Et),e=Object(d.b)(),n=i.a.useState(null),a=Object(I.a)(n,2),c=a[0],o=a[1],s=i.a.useState(!1),u=Object(I.a)(s,2),l=u[0],b=u[1],j=Jt();return Object(r.jsxs)(y.a,{className:j.header,children:[Object(r.jsx)(_t.a,{variant:"h4",className:j.logo,children:"Tasks list"}),Object(r.jsx)("div",{children:t?Object(r.jsx)(ut.a,{onClick:function(){e(St())},disableRipple:!0,endIcon:Object(r.jsx)("span",{className:"material-icons",children:"logout"}),children:"Log Out"}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(ut.a,{onClick:function(t){o(t.currentTarget),b((function(t){return!t}))},disableRipple:!0,endIcon:Object(r.jsx)("span",{className:"material-icons",children:"login"}),children:"Log in"}),Object(r.jsx)(Ut,{anchorEl:c,open:l,onClose:function(){b(!1)}})]})})]})}),Gt=function(){var t=zt();return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)(g,{}),Object(r.jsx)(qt,{}),Object(r.jsx)("div",{className:t.body,children:Object(r.jsx)(Wt,{})})]})},Kt=Object(j.a)({reducer:{tasks:$,tasksListState:Dt,newTaskModal:F,user:Ct,notifications:p}});s.a.render(Object(r.jsx)(d.a,{store:Kt,children:Object(r.jsx)(b.a,{maxSnack:3,children:Object(r.jsx)(Gt,{})})}),document.getElementById("root"))}},[[94,1,2]]]);
//# sourceMappingURL=main.e8376cce.chunk.js.map